# jcasc/02-security-emergency.yaml
# EMERGENCY FALLBACK - Use ONLY if LF SSO is down
# To activate: rename 02-security.yaml to 02-security-saml.yaml.bak
#             rename this file to 02-security.yaml
#             restart Jenkins pod: kubectl delete pod jenkins-staging-0 -n jenkins-staging
# NOTE: CSRF and disableRememberMe configs are in 02-security.yaml to avoid conflicts
---
jenkins:
  # Emergency local authentication - lf-jenkins account with static password
  securityRealm:
    local:
      allowsSignup: false
      users:
        - id: "lf-jenkins"
          name: "LF Jenkins Emergency Admin"
          email: '${JCASC_EMERGENCY_ADMIN_EMAIL}'
          password: '${JCASC_JENKINSSECURITY_ADMINPASSWORD}'
  authorizationStrategy:
    projectMatrix:
      permissions:
        # Emergency admin account - lf-jenkins only
        - "Overall/Administer:lf-jenkins"
        # Standard authenticated users - limited permissions
        - "Overall/Read:authenticated"
        - "Job/Build:authenticated"
        - "Job/Cancel:authenticated"
        - "Job/Read:authenticated"
        - "Job/Workspace:authenticated"
        - "View/Read:authenticated"
